/* Répertoire des images */
<def name="icons" value="/FabWeb/modules/AdminFiles/images" />

/* Détermine la syntaxe à utiliser */
<switch test="{strtolower(Utils::getExtension($file))}">
    <case test=".htm"   ><def name="syntax" value="html"    /></case>
    <case test=".html"  ><def name="syntax" value="html"    /></case>
    <case test=".css"   ><def name="syntax" value="css"     /></case>
    <case test=".js"    ><def name="syntax" value="js"      /></case>
    <case test=".php"   ><def name="syntax" value="php"     /></case>
    <case test=".xml"   ><def name="syntax" value="xml"     /></case>
    <case test=".config"><def name="syntax" value="xml"     /></case>
    <default ><def name="syntax" value="brainfuck" /></default>
</switch>

<script language="javascript" type="text/javascript">
jQuery
(
    function()
    \{
        editAreaLoader.init
        (
            \{
                id : "editor",
                syntax: "$syntax",
                start_highlight: true,
                language: "fr",
                fullscreen: true,
                replace_tab_by_spaces: true,
                allow_toggle: false,
                allow_resize: 'no',
                is_multi_files: false,
                toolbar: "search, go_to_line,|, undo, redo, |, select_font,|, reset_highlight, |, help"
            \}
        );
        editAreaLoader.setSelectionRange('editor', 0, 0);
    \}
);
</script>
<form method="post" action="/{$this->module}/Save">
    <div id="header">
        <toolbar>
            <item img="$icons/page_save.png" type="submit" class="positive">Enregistrer</item>
            <separator />
            <item img="$icons/cross.png" href="/{$this->module}" class="negative">Annuler</item>
        </toolbar>
        <h1>{$this->getTitle()} : $file</h1>
    </div>
    <textarea id="editor" name="content" cols="60" rows="40">{htmlspecialchars($content, ENT_NOQUOTES)}</textarea>
    <hidden name="file" value="$file" />
</form>