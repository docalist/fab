<!--IDEES A ETUDIER QUAND ON SERA EN RETRAITE :-->
<!--<def name="i" value="toto" />-->
<!---->
<!--<template match="//def" name="" value="">-->
<!--    <?php $$name="$value" ?>-->
<!--</template>-->

<!--<template match="//if" test="">-->
<!--    <?php if($test) : ?>-->
<!--        {select('text()|*')}-->
<!--    <?php endif; ?>-->
<!--</template>-->
<!---->
<!--tester les erreurs (par exemple vérifier qu'un switch ne contient pas plus de 1 default):-->
<!--select('//switch[count(default) gt 1]')-->

<!--Faut-il indiquer ou non dans le template les arguments qu'on utilise ?-->
<!--- toutes les variables $xxx utilisées dans le corps du template doivent être déclarées-->
<!--comme attributs du template-->
<!--- au lieu d'utiliser une variable $xxx pour accéder à l'attribut xxx du template -->
<!--il est possible d'utiliser à la place {select('@xxx')}-->
<!--- si vous n'utilisez aucun $xxx, mais seulement des select, vous pouvez ne déclarer-->
<!--aucun attribut dans le template-->
<!---->
<!--A voir à l'usage : si effectivement on n'utilise plus aucun $xxx, mais toujours-->
<!--des select, virer de TemplateCompiler le code qui gère les variables de templates match-->

<!--IDEA: utiliser xslt à la place/en plus des templates match ?-->
<!--ou alors : autoriser dans un template l'utilisation de n'importe quel tag xslt-->


/* TEXTBOX multiligne = : textarea */
@rows != ""
génère un <textarea ... ></textarea>
*/
<template match="//textbox[@rows]" name="" label="" class="" rows="" cols="">
    <label if="'$label'" class="textarea $class" for="{autoId()}">$label</label>
    <textarea
        name="$name"
        title="$label"
        class="text $class"
        rows="$rows"
        cols="$cols"
        id="{lastId()}">
        {select('@*')}
        {select('text(@value)|*)'}
    </textarea>
</template>

/* TEXTBOX correspondant aux zones de textes simples
(pas d'attribut 'rows')
génère un <input type="text" ... />
*/
<template match="//textbox" name="" label="" class="" password="">
    <label if="'$label'" class="text $class" for="{autoId()}">$label</label>
    <input test="'$password'">
        type="text" 
        name="$name" 
        title="$label"
        value="{select('@value|*')}"
        class="text $class" 
        id="{lastId()}">
        {select('@*')}
    </input>
    <input test="$password == ''">
        type="text" 
        name="$name" 
        title="$label"
        value="{select('@value|*')}"
        class="text $class" 
        id="{lastId()}">
        {select('@*')}
    </input>
    {select('node()')}
</template>
        

<!-- TEXTLIST -->
<template match="//widget[@type='textlist']" label="" class="" name="" src="">
    <label if="'$label'" class="textlist $class">$label</label>
    <div class="textlist $class">
        <loop on="$src" as="$line, $record">
            <label class="text $class" for="$name$line" >{$record['label']}</label>
                <input
                    type="text"
                    class="text $class"
                    id="$name$line"
                    name="$name" />
        </loop>
    </div>
</template>


<!-- CHECKBOX -->
<template match="//widget[@type='checkbox']" name="" label="" class="" value="">
    <fill values="$$name" code='checked="checked"' separator="$sep">
        <input
            type="checkbox"
            class="check $class"
            id="{autoId()}"
            name="$name"
            value="$value">
            {select('@*')}
            </input>
        </fill>
        <label if="'$label'" class="check $class" for="{lastId()}">$label</label>
        <!-- Le contenu du tag -->
        {select('node()')}
</template>


<!-- CHECKLIST -->
<template match="//widget[@type='checklist']" label="" class="" name="" src="" tag="">
    <label if="'$label'" class="checklist $class">$label</label>
    <div class="checklist $class">
        <fill values="$name">
            <loop on="$src" as="$line, $record">
                <span class="check $class">{select('@*')}
                    <input
                        type="checkbox"
                        class="check $class"
                        id="$name$line"
                        name="$name"
                        value="{$record['code']}" />
                    <label class="check $class" for="$name$line" >{$record['label']}</label>
                    <if test="'$tag' != ''">&lt;$tag&gt;</if>
                </span>
            </loop>
        </fill>
    </div>
</template>


<!-- RADIO -->
<template match="//widget[@type='radio']" name="" label="" class="" value="">
    <fill values="$$name" code='selected="selected"' separator="$sep">
        <input
            type="radio"
            class="radio $class"
            id="{autoId()}"
            name="$name"
            value="$value">
            {select('@*')}
        </input>
    </fill>
    <label if="'$label'" class="radio $class" for="{lastId()}">$label</label>
    <!-- Le contenu du tag -->
    {select('node()')}
</template>


<!-- RADIOLIST -->
<template match="//widget[@type='radiolist']" label="" class="" name="" src="">
    <label if="'$label'" class="radiolist $class">$label</label>
    <div class="radiolist $class">
        <fill values="$name">
            <loop on="$src" as="$line, $record">
                <span class="radio class">
                    <input
                        type="radio"
                        class="radio $class"
                        id="$name$line"
                        name="$name"
                        value="{$record['code']}" />
                    <label class="radio $class" for="$name$line" >{$record['label']}</label>
                </span>
            </loop>
        </fill>
    </div>
</template>


<!-- TEXTAREA -->
<!--<template match="//widget[@type='textarea']" name="" label="" class="" cols="" rows="">-->
<!--    <label if="'$label'" class="textarea $class" for="{autoId()}">$label</label>-->
<!--    <textarea-->
<!--        class="textarea $class"-->
<!--        name="$name"-->
<!--        title="$label"-->
<!--        cols="$cols"-->
<!--        rows="$rows"-->
<!--        id="{lastId()}">{select('@*')}{select('node()')}</textarea>-->
<!--</template>-->


<!-- TEXTAREALIST -->
<template match="//widget[@type='textarealist']" label="" class="" name="" src="" cols="" rows="">
    <label if="'$label'" class="textarealist $class">$label</label>
    <div class="textarealist $class">
        <loop on="$src" as="$line, $record">
            <label class="textarea $class" for="$name$line" >{$record['label']}</label>
            <textarea
                class="text $class"
                id="$name$line"
                name="$name"
                cols="$cols"
                rows="$rows"> </textarea>
        </loop>
    </div>
</template>


<!-- SUBMIT -->
<template match="//widget[@type='submit']" name="" class="" value="">
    <input
        type="submit"
        class="submit $class"
        name="$name"
        value="$value">
        {select('@*')}
    </input>
    <!-- Le contenu du tag s'il y en a un -->
    {select('node()')} 
</template>


<!-- RESET -->
<template match="//widget[@type='reset']" name="" class="" value="">
    <input
        type="reset"
        class="reset $class"
        name="$name"
        value="$value">
        {select('@*')}
    </input>
    <!-- Le contenu du tag s'il y en a un -->
    {select('node()')} 
</template>


<!-- PASSWORD -->
<template match="//widget[@type='password']" name="" label="" class="" value="">
    <label if="'$label'" class="text $class" for="{autoId()}">$label</label>
    <input
        type="password"
        class="text $class"
        name="$name"
        value="$value"
        id="{lastId()}">
        {select('@*')}  <!-- Eventuellement, les attributs donnÃ©s en plus -->
    </input>
    <!-- Le contenu du tag s'il y en a un -->
    {select('node()')} 
</template>


<!-- FILEUPLOAD -->
<template match="//widget[@type='fileupload']"  name="" label="" class="" value="">
    <label if="'$label'" class="file $class" for="{autoId()}">$label</label>
    <input
        type="file"
        class="file $class"
        name="$name"
        value="$value"
        id="{lastId()}">
        {select('@*')}  <!-- Eventuellement, les attributs donnÃ©s en plus -->
    </input>
    {select('node()')}
</template>
    

<!-- FILELIST -->
<!--<template match="//widget[@type='fileuploadlist']" label="" class="" name="" src="">-->
<!--    <label if="'$label'" class="filelist $class">$label</label>-->
<!--    <div class="filelist $class">-->
<!--        <loop on="$src" as="$line, $record">-->
<!--            <label class="file $class" for="$name$line" >{$record['label']}</label>-->
<!--                <input-->
<!--                    type="file"-->
<!--                    class="file $class"-->
<!--                    id="$name$line"-->
<!--                    name="$name" />-->
<!--        </loop>-->
<!--    </div>-->
<!--</template>-->


<!-- SELECT -->
<!--
Paramêtres :
   - src : la source de données pour les options du select
   - sep : le séparateur d'articles utilisé
     TODO : à enlever ?    
   - emptylabel="true" : indique s'il faut ajouter une valeur vide (-) au select
   - multiple="true" : génère un select à choix multiples au lieu d'un select simple
-->
<template match="//widget[@type='select']" name="" label="" class="" size="" emptylabel="" src="" sep="" >
    <label if="'$label'" class="select $class" for="{autoId()}">$label</label>
    <input type="hidden" name="$name" value="" />
    <fill values="$$name" code='selected="selected"' separator="$sep">
        <select
            class="select $class"
            id="{lastId()}"
            name="$name"
            size="$size">
            {select('@*')}
            <option if="'$emptylabel'" value="" id="{lastId()}-0">-</option>
            <loop on="$src" as="$line, $record">
                <option value="{$record['code']}"
                        id="{lastId()}-{$record['line']}">{$record['label']}</option>
            </loop>
        </select>
    </fill>
</template>

<!-- DIV -->
<!-- conteneur générique pour d'autres contrôles -->
<!--<template match="//widget[@type='div']" type="" name="" label="" class="">-->
<!--    <label if="'$label'" class="div $class" for="{autoId()}">$label</label>-->
<!--    <div id="{lastId()}" class="div $class">{select('@*|node()')}</div>-->
<!--</template>-->

/* TODO : 
<!-- Erreur : aucun des templates widget n'a instancié l'appellant -->
<!--<template match="//widget" type="" name="" label="" class="" value="">-->
<!--    <span style="background-color: #eee; color: red">widget incorrect : &amp;lt;widget type="$type" name="$name" title="$label" ... /&amp;gt;</span>-->
<!--</template>-->